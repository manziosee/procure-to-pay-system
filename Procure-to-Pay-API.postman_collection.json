{
	"info": {
		"_postman_id": "12345678-1234-1234-1234-123456789012",
		"name": "Procure-to-Pay API",
		"description": "Complete API collection for Procure-to-Pay System with multi-level approval workflow",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{access_token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "request_id",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login - Staff",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('access_token', response.access);",
									"    pm.collectionVariables.set('refresh_token', response.refresh);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"staff1\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								""
							]
						}
					}
				},
				{
					"name": "Login - Approver Level 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('access_token', response.access);",
									"    pm.collectionVariables.set('refresh_token', response.refresh);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"approver1\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								""
							]
						}
					}
				},
				{
					"name": "Login - Approver Level 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('access_token', response.access);",
									"    pm.collectionVariables.set('refresh_token', response.refresh);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"approver2\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								""
							]
						}
					}
				},
				{
					"name": "Login - Finance",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('access_token', response.access);",
									"    pm.collectionVariables.set('refresh_token', response.refresh);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"finance1\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login",
								""
							]
						}
					}
				},
				{
					"name": "Refresh Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('access_token', response.access);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"refresh\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/refresh/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"refresh",
								""
							]
						}
					}
				},
				{
					"name": "Get User Profile",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/auth/profile/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"profile",
								""
							]
						}
					}
				}
			]
		},
		{
			"name": "Purchase Requests",
			"item": [
				{
					"name": "Create Request",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('request_id', response.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "title",
									"value": "Office Supplies Request",
									"type": "text"
								},
								{
									"key": "description",
									"value": "Monthly office supplies including paper, pens, and folders",
									"type": "text"
								},
								{
									"key": "amount",
									"value": "1500.00",
									"type": "text"
								},
								{
									"key": "items",
									"value": "[{\"name\": \"Printer Paper\", \"quantity\": 10, \"unit_price\": 25.00}, {\"name\": \"Pens\", \"quantity\": 50, \"unit_price\": 2.00}]",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/api/requests/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								""
							]
						}
					}
				},
				{
					"name": "List Requests",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/requests/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								""
							]
						}
					}
				},
				{
					"name": "Get Request Details",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								""
							]
						}
					}
				},
				{
					"name": "Update Request",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"Updated Office Supplies Request\",\n    \"description\": \"Updated monthly office supplies order\",\n    \"amount\": \"1750.00\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								""
							]
						}
					}
				},
				{
					"name": "Approve Request (Level 1)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"comments\": \"Approved by Level 1 - Budget allocation confirmed\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/approve/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								"approve",
								""
							]
						}
					}
				},
				{
					"name": "Approve Request (Level 2)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"comments\": \"Final approval - PO will be generated automatically\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/approve/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								"approve",
								""
							]
						}
					}
				},
				{
					"name": "Reject Request",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"comments\": \"Budget exceeded for this quarter\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/reject/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								"reject",
								""
							]
						}
					}
				},
				{
					"name": "Submit Receipt",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "receipt",
									"type": "file",
									"src": []
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/api/requests/{{request_id}}/submit-receipt/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"requests",
								"{{request_id}}",
								"submit-receipt",
								""
							]
						}
					}
				}
			]
		},
		{
			"name": "Document Processing",
			"item": [
				{
					"name": "Process Proforma",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "document",
									"type": "file",
									"src": []
								},
								{
									"key": "type",
									"value": "proforma",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/api/documents/process/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"documents",
								"process",
								""
							]
						}
					}
				},
				{
					"name": "Process Receipt",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "document",
									"type": "file",
									"src": []
								},
								{
									"key": "type",
									"value": "receipt",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/api/documents/process/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"documents",
								"process",
								""
							]
						}
					}
				}
			]
		},
		{
			"name": "Workflow Tests",
			"item": [
				{
					"name": "Complete Approval Workflow",
					"item": [
						{
							"name": "1. Login as Staff",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Login successful', function () {",
											"    pm.response.to.have.status(200);",
											"    const response = pm.response.json();",
											"    pm.collectionVariables.set('access_token', response.access);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"username\": \"staff1\",\n    \"password\": \"password123\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/api/auth/login/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"auth",
										"login",
										""
									]
								}
							}
						},
						{
							"name": "2. Create Request",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Request created', function () {",
											"    pm.response.to.have.status(201);",
											"    const response = pm.response.json();",
											"    pm.collectionVariables.set('request_id', response.id);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "title",
											"value": "Workflow Test Request",
											"type": "text"
										},
										{
											"key": "description",
											"value": "Testing complete approval workflow",
											"type": "text"
										},
										{
											"key": "amount",
											"value": "500.00",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "{{base_url}}/api/requests/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"requests",
										""
									]
								}
							}
						},
						{
							"name": "3. Login as Approver L1",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Approver L1 login successful', function () {",
											"    pm.response.to.have.status(200);",
											"    const response = pm.response.json();",
											"    pm.collectionVariables.set('access_token', response.access);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"username\": \"approver1\",\n    \"password\": \"password123\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/api/auth/login/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"auth",
										"login",
										""
									]
								}
							}
						},
						{
							"name": "4. Approve as Level 1",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Level 1 approval successful', function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"comments\": \"Approved by Level 1\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/api/requests/{{request_id}}/approve/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"requests",
										"{{request_id}}",
										"approve",
										""
									]
								}
							}
						},
						{
							"name": "5. Login as Approver L2",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Approver L2 login successful', function () {",
											"    pm.response.to.have.status(200);",
											"    const response = pm.response.json();",
											"    pm.collectionVariables.set('access_token', response.access);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"username\": \"approver2\",\n    \"password\": \"password123\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/api/auth/login/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"auth",
										"login",
										""
									]
								}
							}
						},
						{
							"name": "6. Final Approval (PO Generation)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test('Final approval successful', function () {",
											"    pm.response.to.have.status(200);",
											"    const response = pm.response.json();",
											"    pm.expect(response.request.status).to.eql('approved');",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"comments\": \"Final approval - PO generated\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/api/requests/{{request_id}}/approve/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"api",
										"requests",
										"{{request_id}}",
										"approve",
										""
									]
								}
							}
						}
					]
				}
			]
		}
	]
}